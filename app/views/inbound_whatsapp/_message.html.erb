<div class="message-item">
  <div class="message-content">
    <!-- Avatar -->
    <div class="message-avatar">
      <%= message.profile_name&.first&.upcase || 'U' %>
    </div>

    <!-- Message Body -->
    <div class="message-body">
      <!-- Header -->
      <div class="message-header">
        <div class="message-sender">
          <span class="message-sender-name">
            <%= message.profile_name || 'Unknown' %>
          </span>
          <span class="message-sender-phone">
            <%= message.from %>
          </span>
        </div>
        <time class="message-time" datetime="<%= message.created_at.iso8601 %>">
          <%= message.created_at.strftime('%b %d, %I:%M %p') %>
        </time>
      </div>

      <!-- Message Content -->
      <div>
        <% if message.message_type == 'reply' %>
          <!-- Interactive Button Reply -->
          <div class="message-reply">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122" />
            </svg>
            <div class="message-reply-content">
              <span class="message-reply-label">Button Reply</span>
              <span class="message-reply-text"><%= message.text %></span>
              <% if message.reply_data.present? %>
                <% reply = JSON.parse(message.reply_data) rescue {} %>
                <% if reply['id'].present? %>
                  <span class="message-reply-id">ID: <%= reply['id'] %></span>
                <% end %>
              <% end %>
            </div>
          </div>
        <% elsif message.message_type == 'text' %>
          <!-- Regular Text Message -->
          <div class="message-text"><%= message.text %></div>
        <% else %>
          <!-- Other Message Types -->
          <div class="message-other">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
            </svg>
            <div>
              <span class="message-other-label"><%= message.message_type || 'Unknown' %></span>
              <span class="message-other-text"><%= message.text %></span>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Metadata -->
      <div class="message-metadata">
        <span class="message-metadata-item">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
          </svg>
          To: <%= message.to %>
        </span>
        <span class="message-metadata-item">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          UUID: <%= message.message_uuid&.first(8) %>...
        </span>
      </div>
    </div>
  </div>
</div>
